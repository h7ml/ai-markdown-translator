# AI Markdown Translator 基准测试工具

这个目录包含 AI Markdown Translator 项目的基准测试工具，用于评估不同 AI 模型在翻译 Markdown 文档时的性能和质量。

## 功能特点

- 测试多种 AI 模型（包括 OpenAI、Claude、Qwen 等）的翻译能力
- 支持多语言翻译质量评估（英语、中文、日语、韩语等）
- 收集执行时间和 token 消耗指标
- 评估翻译内容的质量，包括语义保留度、格式保留度等
- 自动生成详细分析报告和模型排名

## 目录结构

```
benchmark/
├── README.md          # 本文档
├── index.js           # 批量测试执行入口
├── benchmark.js       # 核心测试功能实现
├── testsuit.js        # 测试模型和翻译用例定义
├── evaluate.js        # 翻译质量评估工具
├── analyze.js         # 报告分析和统计工具
├── report/            # 原始测试报告 JSON 文件
└── results/           # 生成的翻译示例
```

## 使用方法

### 1. 运行基准测试

你可以使用以下命令运行基准测试：

```bash
# 使用脚本工具
./script/test.sh --benchmark

# 或直接通过 npm 运行
npm run benchmark
```

这将按照 `testsuit.js` 中定义的模型和测试用例执行翻译测试，并在 `benchmark/report` 目录中生成结果报告。

### 2. 分析测试结果

完成测试后，你可以分析所有测试结果并生成综合报告：

```bash
# 使用脚本工具
./script/test.sh --analyze

# 或直接通过 npm 运行
npm run analyze
```

分析报告将保存在 `benchmark` 目录下，并在控制台输出关键统计信息。

## 评估指标

基准测试使用以下指标来评估翻译模型性能：

1. **翻译质量指标**（占总分 45%）：
   - 语义准确性（0-10 分）：翻译是否保留了原文的含义
   - Markdown 格式保留（0-10 分）：是否正确保留了所有 Markdown 语法
   - 术语一致性（0-10 分）：专业术语翻译是否一致
   - 语言流畅度（0-10 分）：翻译是否自然流畅
   - 风格匹配（0-10 分）：是否保持了原文的风格

2. **稳定性指标**（占总分 20%）：
   - 是否能够正确处理复杂的 Markdown 结构
   - 基于成功率评分（0-10 分）

3. **执行效率**（占总分 20%）：
   - 执行时间（0-10 分，5 秒内满分）

4. **资源消耗**（占总分 15%）：
   - Token 成本（0-10 分，基于消耗标准）

## 自定义测试

你可以在 `testsuit.js` 文件中修改测试模型和测试用例：

```javascript
// 添加或修改要测试的模型
export const testModels = [
  { name: "gpt-4o", from: "api", inputCost: 8.75, outputCost: 35 },
  { name: "claude-3-5-haiku-20241022", from: "api", inputCost: 7, outputCost: 35 },
  // 添加更多模型...
];

// 修改测试用例
export const testCases = [
  {
    name: "技术文档",
    content: `# 示例技术文档
这是一个包含**加粗**和*斜体*的 Markdown 文档`,
    targetLanguage: "Japanese"
  },
  // 添加更多测试用例...
];
```

## 输出示例

基准测试将输出类似以下内容的结果：

```
=== 分析报告摘要 ===
总测试数: 20
模型数量: 4
测试用例数量: 5

性能排名:
1. gpt-4o (技术文档 -> 日语)
   综合得分: 9.15
   - 翻译质量(45%): 9.52
   - 稳定性(20%): 10.00
   - 时间消耗(20%): 8.40
   - 成本消耗(15%): 7.20
   样本数: 5 (有效: 5)
   平均耗时: 3.25s
   Token成本: 0.00625元

2. claude-3-5-haiku-20241022 (技术文档 -> 日语)
   ...
```

## 注意事项

- 运行基准测试前，请确保已在 `.env.local` 文件中设置了必要的 API 密钥
- 翻译结果可能因模型版本、API 响应时间等因素而有所不同
- 评估标准和权重可以在 `analyze.js` 中进行调整
- 建议使用多个测试用例和语言组合来获得更全面的评估结果
